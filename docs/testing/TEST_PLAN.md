# –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Tradr - –í—ã–ø–æ–ª–Ω–µ–Ω–æ ‚úÖ

## üìä –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å

**–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: 111 ‚úÖ**
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ~4.5 —Å–µ–∫—É–Ω–¥—ã**
**–í—Å–µ —à–∞–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!**

---

## ‚úÖ –®–∞–≥ 0: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ì–û–¢–û–í–û)

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Jest, mongodb-memory-server)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω Jest –∫–æ–Ω—Ñ–∏–≥
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã helpers –¥–ª—è –ë–î –∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ 14 —Ç–µ—Å—Ç–æ–≤ –¥–ª—è Portfolio –º–æ–¥–µ–ª–∏

**–§–∞–π–ª—ã**:
- `src/__tests__/helpers/db.ts`
- `src/__tests__/helpers/auth.ts`
- `src/__tests__/helpers/testData.ts`
- `src/__tests__/api/portfolios/portfolio.test.ts` - 14 —Ç–µ—Å—Ç–æ–≤

---

## ‚úÖ –®–∞–≥ 1: –§–æ—Ä–º—É–ª—ã —Ä–∞—Å—á–µ—Ç–∞ (–ì–û–¢–û–í–û)

**–°—Ç–∞—Ç—É—Å**: ‚úÖ 16 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ**:
- ‚úÖ `src/lib/calculations.ts` - 6 —Ñ—É–Ω–∫—Ü–∏–π —Ä–∞—Å—á–µ—Ç–∞
- ‚úÖ `src/__tests__/lib/calculations.test.ts` - 16 —Ç–µ—Å—Ç–æ–≤

**–§—É–Ω–∫—Ü–∏–∏**:
1. `calculateLongProfitUSD()` - –ø—Ä–æ—Ñ–∏—Ç LONG –≤ USD
2. `calculateLongProfitPercent()` - –ø—Ä–æ—Ñ–∏—Ç LONG –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
3. `calculateShortProfitCoins()` - –ø—Ä–æ—Ñ–∏—Ç SHORT –≤ –º–æ–Ω–µ—Ç–∞—Ö
4. `calculateShortProfitPercent()` - –ø—Ä–æ—Ñ–∏—Ç SHORT –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
5. `calculateCoinsBoughtBack()` - —Å–∫–æ–ª—å–∫–æ –º–æ–Ω–µ—Ç –≤—ã–∫—É–ø–ª–µ–Ω–æ
6. `recalculateLongEntryPrice()` - –ø–µ—Ä–µ—Å—á–µ—Ç entry price –ø–æ—Å–ª–µ SHORT

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã**:
- ‚ö†Ô∏è LONG profit USD calculation (—Å—Ç—Ä–æ–∫–∞ 12)
- ‚ö†Ô∏è SHORT profit coins calculation (—Å—Ç—Ä–æ–∫–∞ 157)
- ‚ö†Ô∏è recalculateLongEntryPrice (—Å—Ç—Ä–æ–∫–∞ 289)

---

## ‚úÖ –®–∞–≥ 2: Trade –º–æ–¥–µ–ª—å (–ì–û–¢–û–í–û)

**–°—Ç–∞—Ç—É—Å**: ‚úÖ 18 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ**:
- ‚úÖ `src/__tests__/models/trade.test.ts` - 18 —Ç–µ—Å—Ç–æ–≤

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è**:
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ LONG trade
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ SHORT trade
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π (status, tradeType, prices, amounts)
- ‚úÖ Timestamps –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è
- ‚úÖ Partial close –ø–æ–ª—è (remainingAmount, isPartialClose)
- ‚úÖ Trade status transitions

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã**:
- ‚ö†Ô∏è initialEntryPrice never changes (—Å—Ç—Ä–æ–∫–∞ 315)
- ‚ö†Ô∏è initialAmount never changes (—Å—Ç—Ä–æ–∫–∞ 346)

---

## ‚úÖ –®–∞–≥ 3: LONG Lifecycle (–ì–û–¢–û–í–û)

**–°—Ç–∞—Ç—É—Å**: ‚úÖ 9 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ**:
- ‚úÖ `src/__tests__/scenarios/long-lifecycle.test.ts` - 9 —Ç–µ—Å—Ç–æ–≤

**–°—Ü–µ–Ω–∞—Ä–∏–∏**:
- ‚úÖ Opening LONG position
- ‚úÖ Filling LONG with exchange data
- ‚úÖ Closing LONG with profit
- ‚úÖ Closing LONG with loss
- ‚úÖ Complete lifecycle: Open ‚Üí Fill ‚Üí Close
- ‚úÖ Edge cases (small amounts, high fees, break-even)

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç**:
- ‚ö†Ô∏è Profit calculation in real scenario (—Å—Ç—Ä–æ–∫–∞ 114)

---

## ‚úÖ –®–∞–≥ 4: SHORT Lifecycle (–ì–û–¢–û–í–û)

**–°—Ç–∞—Ç—É—Å**: ‚úÖ 9 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ**:
- ‚úÖ `src/__tests__/scenarios/short-lifecycle.test.ts` - 9 —Ç–µ—Å—Ç–æ–≤

**–°—Ü–µ–Ω–∞—Ä–∏–∏**:
- ‚úÖ Opening SHORT from LONG
- ‚úÖ Filling SHORT with exchange data
- ‚úÖ Closing SHORT with profit ‚Üí parent LONG update
- ‚úÖ Closing SHORT with loss
- ‚úÖ Parent LONG recalculation (entry price, amount)
- ‚úÖ Multiple SHORT operations on same LONG

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã**:
- ‚ö†Ô∏è Close SHORT with profit and update parent LONG (—Å—Ç—Ä–æ–∫–∞ 104)
- ‚ö†Ô∏è Preserve initialEntryPrice and initialAmount (—Å—Ç—Ä–æ–∫–∞ 160)
- ‚ö†Ô∏è Recalculate entry price correctly (—Å—Ç—Ä–æ–∫–∞ 170)

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è**:
```typescript
// –ü–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è SHORT:
‚úÖ parent.amount —É–≤–µ–ª–∏—á–∏–ª—Å—è (–¥–æ–±–∞–≤–∏–ª–∏—Å—å –≤—ã–∫—É–ø–ª–µ–Ω–Ω—ã–µ –º–æ–Ω–µ—Ç—ã)
‚úÖ parent.entryPrice –ø–µ—Ä–µ—Å—á–∏—Ç–∞–ª—Å—è
‚úÖ parent.initialEntryPrice –ù–ï –∏–∑–º–µ–Ω–∏–ª—Å—è (–ö–†–ò–¢–ò–ß–ù–û!)
‚úÖ parent.initialAmount –ù–ï –∏–∑–º–µ–Ω–∏–ª—Å—è (–ö–†–ò–¢–ò–ß–ù–û!)
```

---

## ‚úÖ –®–∞–≥ 5: Partial Close (–ì–û–¢–û–í–û)

**–°—Ç–∞—Ç—É—Å**: ‚úÖ 9 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ**:
- ‚úÖ `src/__tests__/scenarios/partial-close.test.ts` - 9 —Ç–µ—Å—Ç–æ–≤

**–°—Ü–µ–Ω–∞—Ä–∏–∏**:
- ‚úÖ Partial close LONG (—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π)
- ‚úÖ Update parent LONG remainingAmount
- ‚úÖ Multiple partial closes on same LONG
- ‚úÖ Close parent LONG when all partials complete
- ‚úÖ Partial close SHORT with proportional parent update
- ‚úÖ Profit calculation for partial portions

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç**:
- ‚ö†Ô∏è Update parent LONG remainingAmount (—Å—Ç—Ä–æ–∫–∞ 38)

---

## ‚úÖ –®–∞–≥ 6: Statistics (–ì–û–¢–û–í–û)

**–°—Ç–∞—Ç—É—Å**: ‚úÖ 9 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ**:
- ‚úÖ `src/__tests__/scenarios/statistics.test.ts` - 9 —Ç–µ—Å—Ç–æ–≤

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è**:

### LONG Statistics
- ‚úÖ Total profit USD (–∞–≥—Ä–µ–≥–∞—Ü–∏—è)
- ‚úÖ Win rate (–ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫)
- ‚úÖ Average profit USD
- ‚úÖ Average profit percent

### SHORT Statistics
- ‚úÖ Total profit coins (–ø–æ —Å–∏–º–≤–æ–ª–∞–º: BTC, ETH –æ—Ç–¥–µ–ª—å–Ω–æ)
- ‚úÖ Win rate –¥–ª—è SHORT

### –û–±—â–µ–µ
- ‚úÖ Performance by coin (–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞)
- ‚úÖ Best and worst trades
- ‚úÖ Mixed portfolio (LONG –∏ SHORT –æ—Ç–¥–µ–ª—å–Ω–æ)

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã**:
- ‚ö†Ô∏è Total profit USD for LONG (—Å—Ç—Ä–æ–∫–∞ 23)
- ‚ö†Ô∏è Win rate calculation (—Å—Ç—Ä–æ–∫–∞ 48)
- ‚ö†Ô∏è Total profit coins for SHORT (by symbol) (—Å—Ç—Ä–æ–∫–∞ 114)

---

## ‚úÖ –®–∞–≥ 7: API Endpoints (–ì–û–¢–û–í–û)

**–°—Ç–∞—Ç—É—Å**: ‚úÖ 27 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç (14 Portfolio + 13 Trades)

**–ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ**:
- ‚úÖ `src/__tests__/api/portfolios/api-endpoints.test.ts` - 14 —Ç–µ—Å—Ç–æ–≤
- ‚úÖ `src/__tests__/api/trades/api-endpoints.test.ts` - 13 —Ç–µ—Å—Ç–æ–≤

### Portfolio API (14 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ POST /api/portfolios - create
- ‚úÖ GET /api/portfolios - list all
- ‚úÖ GET /api/portfolios/[id] - get single
- ‚úÖ PUT /api/portfolios/[id] - update
- ‚úÖ DELETE /api/portfolios/[id] - delete
- ‚úÖ Validation (percentages, coins)
- ‚úÖ Authentication (401 unauthorized)
- ‚úÖ Authorization (403 forbidden for other users)

### Trades API (13 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ POST /api/portfolios/[portfolioId]/trades - create LONG
- ‚úÖ POST /api/portfolios/[portfolioId]/trades - create SHORT
- ‚úÖ GET /api/portfolios/[portfolioId]/trades - list
- ‚úÖ PUT /api/trades/[id] - update
- ‚úÖ PUT /api/trades/[id] - close SHORT ‚Üí parent LONG update
- ‚úÖ DELETE /api/trades/[id] - delete
- ‚úÖ Validation (coin in portfolio, SHORT amount)
- ‚úÖ Authentication (401)
- ‚úÖ Authorization (403)

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã**:
- ‚ö†Ô∏è Authentication enforcement (—Å—Ç—Ä–æ–∫–∞ 42)
- ‚ö†Ô∏è Authorization check - no access to other users (—Å—Ç—Ä–æ–∫–∞ 231)
- ‚ö†Ô∏è SHORT trade validation (—Å—Ç—Ä–æ–∫–∞ 171)
- ‚ö†Ô∏è Parent LONG recalculation on SHORT close (—Å—Ç—Ä–æ–∫–∞ 409)

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è**:
```typescript
// API Security:
‚úÖ 401 Unauthorized –±–µ–∑ —Å–µ—Å—Å–∏–∏
‚úÖ 403 Forbidden –¥–ª—è —á—É–∂–∏—Ö –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ/—Ç—Ä–µ–π–¥–æ–≤
‚úÖ Validation –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

// Business Logic:
‚úÖ SHORT validation (amount –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç available)
‚úÖ Parent LONG recalculation –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ SHORT
‚úÖ initialEntryPrice –∏ initialAmount –Ω–µ –º–µ–Ω—è—é—Ç—Å—è
```

---

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
src/__tests__/
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îî‚îÄ‚îÄ calculations.test.ts         ‚úÖ 16 —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ trade.test.ts                ‚úÖ 18 —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ scenarios/
‚îÇ   ‚îú‚îÄ‚îÄ long-lifecycle.test.ts       ‚úÖ 9 —Ç–µ—Å—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ short-lifecycle.test.ts      ‚úÖ 9 —Ç–µ—Å—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ partial-close.test.ts        ‚úÖ 9 —Ç–µ—Å—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ statistics.test.ts           ‚úÖ 9 —Ç–µ—Å—Ç–æ–≤
‚îî‚îÄ‚îÄ api/
    ‚îú‚îÄ‚îÄ portfolios/
    ‚îÇ   ‚îú‚îÄ‚îÄ portfolio.test.ts        ‚úÖ 14 —Ç–µ—Å—Ç–æ–≤
    ‚îÇ   ‚îî‚îÄ‚îÄ api-endpoints.test.ts    ‚úÖ 14 —Ç–µ—Å—Ç–æ–≤
    ‚îî‚îÄ‚îÄ trades/
        ‚îî‚îÄ‚îÄ api-endpoints.test.ts    ‚úÖ 13 —Ç–µ—Å—Ç–æ–≤

–í—Å–µ–≥–æ: 111 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
```

---

## üìä –ü–æ–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢–µ—Å—Ç–æ–≤ | –°—Ç–∞—Ç—É—Å |
|-----------|--------|--------|
| Models (Portfolio, Trade) | 32 | ‚úÖ 100% |
| Calculations | 16 | ‚úÖ 100% |
| LONG Lifecycle | 9 | ‚úÖ 100% |
| SHORT Lifecycle | 9 | ‚úÖ 100% |
| Partial Close | 9 | ‚úÖ 100% |
| Statistics | 9 | ‚úÖ 100% |
| API Endpoints | 27 | ‚úÖ 100% |
| **–ò–¢–û–ì–û** | **111** | **‚úÖ 100%** |

---

## üõ†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ

### 1. MongoDB connection –≤ —Ç–µ—Å—Ç–∞—Ö
**–ü—Ä–æ–±–ª–µ–º–∞**: API routes –ø—ã—Ç–∞–ª–∏—Å—å –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ (MongoDB Memory Server)

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ `src/lib/mongodb.ts`:
```typescript
if (mongoose.connection.readyState === 1) {
  return mongoose; // Already connected
}
```

### 2. Floating point precision
**–ü—Ä–æ–±–ª–µ–º–∞**: `expect(0.03).toBe(0.030000000000000002)` –ø–∞–¥–∞–ª

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `toBeCloseTo()` –≤–º–µ—Å—Ç–æ `toBe()`:
```typescript
expect(updatedParent?.remainingAmount).toBeCloseTo(0.03, 4);
```

### 3. SHORT close workflow –≤ API
**–ü—Ä–æ–±–ª–µ–º–∞**: API —Ç—Ä–µ–±—É–µ—Ç exitPrice –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞

**–†–µ—à–µ–Ω–∏–µ**: –í —Ç–µ—Å—Ç–∞—Ö —Ä–∞–∑–±–∏–ª–∏ –Ω–∞ –¥–≤–∞ –∑–∞–ø—Ä–æ—Å–∞:
```typescript
// 1. Set exitPrice first
await UPDATE_TRADE({ exitPrice: 100000, exitFee: 1 });

// 2. Then close
await UPDATE_TRADE({ status: 'closed' });
```

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Å—Ç–∞

### 1. initialEntryPrice –∏ initialAmount
**–ù–ò–ö–û–ì–î–ê –ù–ï –ú–ï–ù–Ø–Æ–¢–°–Ø** –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è trade!

–¢–µ—Å—Ç—ã:
- `trade.test.ts:315`
- `trade.test.ts:346`
- `short-lifecycle.test.ts:160`

### 2. Parent LONG recalculation
–ö–æ–≥–¥–∞ SHORT –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è:
```typescript
‚úÖ newAmount = remainingAmount + coinsBoughtBack
‚úÖ newEntryPrice = sumPlusFee / newAmount
‚ùå initialEntryPrice –ù–ï –º–µ–Ω—è–µ—Ç—Å—è
‚ùå initialAmount –ù–ï –º–µ–Ω—è–µ—Ç—Å—è
```

–¢–µ—Å—Ç—ã:
- `short-lifecycle.test.ts:104`
- `api-endpoints.test.ts:409`

### 3. SHORT profit –≤ –º–æ–Ω–µ—Ç–∞—Ö, –Ω–µ –≤ USD
SHORT –≤—Å–µ–≥–¥–∞ –ø—Ä–æ—Ñ–∏—Ç–∏—Ç –≤ –º–æ–Ω–µ—Ç–∞—Ö, –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç—Å—è –ø–æ —Å–∏–º–≤–æ–ª–∞–º:
```typescript
{ BTC: 0.03, ETH: 1.5 }
```

–¢–µ—Å—Ç—ã:
- `calculations.test.ts:157`
- `statistics.test.ts:114`

### 4. Authentication & Authorization
**–ö–ê–ñ–î–´–ô** API endpoint –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- –ï—Å—Ç—å –ª–∏ —Å–µ—Å—Å–∏—è? (401 Unauthorized)
- –í–ª–∞–¥–µ–ª–µ—Ü –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å? (403 Forbidden)

–¢–µ—Å—Ç—ã:
- `api-endpoints.test.ts:42` (authentication)
- `api-endpoints.test.ts:231` (authorization)

---

## üìù –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –ø–ª–∞–Ω

### –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ—Å—Ç–æ–≤
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ
npm test

# –ü–æ —à–∞–≥–∞–º
npm test calculations    # –®–∞–≥ 1
npm test trade.test      # –®–∞–≥ 2
npm test long-lifecycle  # –®–∞–≥ 3
npm test short-lifecycle # –®–∞–≥ 4
npm test partial-close   # –®–∞–≥ 5
npm test statistics      # –®–∞–≥ 6
npm test api-endpoints   # –®–∞–≥ 7
```

### –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤
1. –û–ø—Ä–µ–¥–µ–ª–∏ –∫ –∫–∞–∫–æ–º—É —à–∞–≥—É –æ—Ç–Ω–æ—Å–∏—Ç—Å—è
2. –î–æ–±–∞–≤—å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª
3. –î–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö - –¥–æ–±–∞–≤—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π `‚ö†Ô∏è CRITICAL TEST`
4. –û–±–Ω–æ–≤–∏ —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç

### –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
```bash
# –û–¥–∏–Ω —Ç–µ—Å—Ç
npm test -- -t "should calculate profit"

# –° –ª–æ–≥–∞–º–∏
npm test -- --verbose

# Debug mode
node --inspect-brk node_modules/.bin/jest
```

---

## ‚úÖ –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω –Ω–∞ 100%

**–ù–∞—á–∞—Ç–æ**: –Ø–Ω–≤–∞—Ä—å 2025
**–ó–∞–≤–µ—Ä—à–µ–Ω–æ**: –Ø–Ω–≤–∞—Ä—å 2025
**–í—Ä–µ–º—è –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**: ~8 —á–∞—Å–æ–≤
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: 111 —Ç–µ—Å—Ç–æ–≤, –≤—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç ‚úÖ

---

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- [ ] UI Component tests
- [ ] E2E tests
- [ ] Performance tests
- [ ] Coverage > 90%
